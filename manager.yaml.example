# Process Manager Configuration
# Add or remove programs to manage here

# Web UI settings
web_ui:
  host: "0.0.0.0"      # Bind to all interfaces (use "127.0.0.1" for localhost only)
  port: 10000          # Web UI port
  title: "My Services" # Dashboard title

# Global Python Virtual Environment
# Path to venv directory (relative to this config file or absolute)
# Can be overridden per-program
venv: ".venv"

# Global Working Directory (optional)
# If set, all programs will run in this directory by default
# Can be overridden per-program
# cwd: "/data/apps"

# Restart settings
restart:
  delay_seconds: 1                # Wait time before restarting a failed process
  max_consecutive_failures: 10    # Mark as broken after N consecutive failures
  failure_reset_seconds: 60       # Reset failure count after stable run (seconds)

# Logging settings
logging:
  max_size_mb: 10      # Maximum log file size before rotation (copytruncate method)

# Programs to run and monitor
programs:
  # Simple program - uses global venv and runs in config directory
  - name: "Simple App"
    script: my_app.py
    enabled: true

  # Program with command-line arguments
  - name: "Web Server"
    script: server.py
    enabled: true
    args: ["--host", "0.0.0.0", "--port", "8080", "--workers", "4"]

  # Program with environment variables
  - name: "Data Collector"
    script: collector.py
    enabled: true
    environment:
      - PYTHONUNBUFFERED=TRUE
      - DTU_HOST=192.168.1.132
      - UPDATE_EVERY=45
      - LOG_LEVEL=INFO

  # Program with custom venv (e.g., older Python version)
  - name: "Legacy App"
    script: legacy_app.py
    enabled: true
    venv: ".venv-python37"

  # Program with custom working directory
  - name: "Background Worker"
    script: worker.py
    enabled: true
    cwd: "/data/apps/worker"
    args: "--verbose"

  # Full example with all options
  - name: "Production API"
    script: api.py
    enabled: true
    venv: ".venv-api"                    # Custom virtual environment
    cwd: "/data/apps/api"                # Custom working directory
    args: ["--config", "production.yaml"] # Command-line arguments
    environment:                          # Environment variables
      - PYTHONUNBUFFERED=TRUE
      - ENVIRONMENT=production
      - DATABASE_URL=postgresql://localhost/mydb
      - REDIS_URL=redis://localhost:6379
      - API_KEY=your-api-key-here

  # Disabled program (won't auto-start)
  - name: "Test Program"
    script: test.py
    enabled: false
